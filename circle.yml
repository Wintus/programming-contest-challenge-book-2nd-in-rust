machine:
  environment:
    CARGO_HOME: $HOME/.cargo
    PATH: $PATH:$CARGO_HOME/bin

dependencies:
  cache_directories:
    - ~/.cargo
    - ~/.rustup
  pre:
    - >- # install rust unless `cargo` exists
      hash cargo 2>/dev/null ||
      curl -sSf https://sh.rustup.rs | sh /dev/stdin -y
    - rustup install stable
    - rustup default stable
  override:
    - cargo build

test:
  override:
    - cargo test
